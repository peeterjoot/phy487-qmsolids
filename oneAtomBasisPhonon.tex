%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{oneAtomBasisPhonon}
%\renewcommand{\dirname}{notes/phy487/}
%\newcommand{\keywords}{Condensed matter physics, PHY487H1F, phonon, one atom basis, angular frequency, harmonic oscillator, dispersion relation}
%\input{../peeter_prologue_print2.tex}
%
%%\citep{harald2003solid} \S x.y
%%\citep{ibach2009solid} \S x.y
%%\reading \citep{ashcroft1976solid} \chaptext N.
%
%%\usepackage{mhchem}
%\usepackage[version=3]{mhchem}
%\usepackage{units}
%\newcommand{\nought}[0]{\circ}
%%\newcommand{\EF}[0]{\epsilon_{\txtF}}
%\newcommand{\EF}[0]{E_{\txtF}}
%\newcommand{\kF}[0]{k_{\txtF}}
%
%\beginArtNoToc
%\generatetitle{One atom basis phonons in 2D}

%\chapter{One atom basis phonons in 2D}
\label{chap:oneAtomBasisPhonon}

\makeoproblem{One atom basis phonons in 2D}{pr:oneAtomBasisPhonon:1}{2013 final exam}{
Tackle the 2D problem of the final exam, generalizing from a square lattice to a general one atom basis in 2D.  The lattice geometry to consider is illustrated in \cref{fig:oneAtomBasisNearestNeighbours:oneAtomBasisNearestNeighboursFig1}.

\imageFigure{../../figures/phy487/oneAtomBasisNearestNeighboursFig1}{Oblique one atom basis}{fig:oneAtomBasisNearestNeighbours:oneAtomBasisNearestNeighboursFig1}{0.3}

Here, \(\Ba\) and \(\Bb\) are the vector differences between the equilibrium positions separating the masses along the \(K_1\) and \(K_2\) interaction directions respectively.
} % makeproblem

\makeanswer{pr:oneAtomBasisPhonon:1}{

%\section{One atom basis phonons in 2D}
\index{one atom basis}

The equilibrium spacing for the cross coupling harmonic forces are

\begin{dmath}\label{eqn:oneAtomBasisPhonon:40}
\begin{aligned}
\Br &= (\Bb + \Ba)/2 \\
\Bs &= (\Bb - \Ba)/2.
\end{aligned}
\end{dmath}

Based on previous calculations, we can write the equations of motion by inspection

\begin{dmath}\label{eqn:oneAtomBasisPhonon:20}
\begin{aligned}
m \ddot{\Bu}_\Bn
=
&-K_1 \Proj_{\acap} \sum_\pm
\lr{ \Bu_\Bn - \Bu_{\Bn \pm(1, 0)}}^2 \\
&-K_2 \Proj_{\bcap} \sum_\pm
\lr{ \Bu_\Bn - \Bu_{\Bn \pm(0, 1)}}^2 \\
&-K_3 \Proj_{\rcap} \sum_\pm
\lr{ \Bu_\Bn - \Bu_{\Bn \pm(1, 1)}}^2 \\
&-K_4 \Proj_{\scap} \sum_\pm
\lr{ \Bu_\Bn - \Bu_{\Bn \pm(1, -1)}}^2.
\end{aligned}
\end{dmath}

Inserting the trial solution

\begin{dmath}\label{eqn:oneAtomBasisPhonon:60}
\Bu_\Bn = \inv{\sqrt{m}} \Bepsilon(\Bq) e^{i( \Br_\Bn \cdot \Bq - \omega t) },
\end{dmath}

and using the matrix form for the projection operators, we have

\begin{dmath}\label{eqn:oneAtomBasisPhonon:80}
\begin{aligned}
\omega^2 \Bepsilon
&=
\frac{K_1}{m} \acap \acap^\T \Bepsilon
\sum_\pm
\lr{ 1 - e^{\pm i \Ba \cdot \Bq} } \\
& +
\frac{K_2}{m} \bcap \bcap^\T \Bepsilon
\sum_\pm
\lr{ 1 - e^{\pm i \Bb \cdot \Bq} } \\
& +
\frac{K_3}{m} \bcap \bcap^\T \Bepsilon
\sum_\pm
\lr{ 1 - e^{\pm i (\Bb + \Ba) \cdot \Bq} } \\
& +
\frac{K_3}{m} \bcap \bcap^\T \Bepsilon
\sum_\pm
\lr{ 1 - e^{\pm i (\Bb - \Ba) \cdot \Bq} } \\
&=
\frac{4 K_1}{m} \acap \acap^\T \Bepsilon \sin^2
\lr{ \Ba \cdot \Bq/2 }
+
\frac{4 K_2}{m} \bcap \bcap^\T \Bepsilon \sin^2
\lr{ \Bb \cdot \Bq/2 } \\
&+
\frac{4 K_3}{m} \rcap \rcap^\T \Bepsilon \sin^2
\lr{ (\Bb + \Ba) \cdot \Bq/2 }
+
\frac{4 K_4}{m} \scap \scap^\T \Bepsilon \sin^2
\lr{ (\Bb - \Ba) \cdot \Bq/2 }.
\end{aligned}
\end{dmath}

This fully specifies our eigenvalue problem.  Writing

\begin{subequations}
\begin{dmath}\label{eqn:oneAtomBasisPhonon:340}
\begin{aligned}
S_1 &= \sin^2
\lr{ \Ba \cdot \Bq/2 } \\
S_2 &= \sin^2
\lr{ \Bb \cdot \Bq/2 } \\
S_3 &= \sin^2
\lr{ (\Bb + \Ba) \cdot \Bq/2 } \\
S_4 &= \sin^2
\lr{ (\Bb - \Ba) \cdot \Bq/2 }
\end{aligned}
\end{dmath}
\boxedEquation{eqn:oneAtomBasisPhonon:100}{
A =
\frac{4}{m}
\lr{ K_1 S_1 \acap \acap^\T + K_2 S_2 \bcap \bcap^\T + K_3 S_3 \rcap \rcap^\T + K_4 S_4 \scap \scap^\T},
}
\end{subequations}

we wish to solve

\begin{equation}\label{eqn:oneAtomBasisPhonon:120}
A \Bepsilon = \omega^2 \Bepsilon = \lambda \Bepsilon.
\end{equation}

Neglecting the specifics of the matrix at hand, consider a generic two by two matrix

\begin{dmath}\label{eqn:oneAtomBasisPhonon:140}
A =
\begin{bmatrix}
a & b \\
c & d
\end{bmatrix},
\end{dmath}

for which the characteristic equation is

\begin{dmath}\label{eqn:oneAtomBasisPhonon:160}
0 =
\begin{vmatrix}
\lambda - a & - b \\
-c & \lambda -d
\end{vmatrix}
=
(\lambda - a)(\lambda - d) - b c
=
\lambda^2 - (a + d) \lambda + a d - b c
=
\lambda^2 - (Tr A) \lambda + \Abs{A}
=
\lr{\lambda - \frac{Tr A}{2}}^2
-
\lr{\frac{Tr A}{2}}^2
 + \Abs{A}.
\end{dmath}

So our angular frequencies are given by

\begin{dmath}\label{eqn:oneAtomBasisPhonon:180}
\omega^2 =
\inv{2}
\lr{ Tr A \pm \sqrt{ \left(Tr A\right)^2 - 4 \Abs{A} }}.
\end{dmath}

The square root can be simplified slightly

\begin{dmath}\label{eqn:oneAtomBasisPhonon:480}
\lr{Tr A}^2
- 4 \Abs{A}
=
(a + d)^2 -4 (a d - b c)
=
a^2 + d^2 + 2 a d - 4 a d + 4 b c
=
(a - d)^2 + 4 b c,
\end{dmath}

so that, finally, the dispersion relation is

\boxedEquation{eqn:oneAtomBasisPhonon:640}{
\omega^2 =
\inv{2}
\lr{ d + a   \pm \sqrt{ (d - a)^2 + 4 b c } },
}

Our eigenvectors will be given by

\begin{dmath}\label{eqn:oneAtomBasisPhonon:200}
0 = (\lambda - a) \Bepsilon_1 - b\Bepsilon_2,
\end{dmath}

or

\begin{dmath}\label{eqn:oneAtomBasisPhonon:220}
\Bepsilon_1 \propto \frac{b}{\lambda - a}\Bepsilon_2.
\end{dmath}

So, our eigenvectors, the vectoral components of our atomic displacements, are

\begin{dmath}\label{eqn:oneAtomBasisPhonon:240}
\Bepsilon \propto
\begin{bmatrix}
b \\
\omega^2 - a
\end{bmatrix},
\end{dmath}

or

\boxedEquation{eqn:oneAtomBasisPhonon:500}{
\Bepsilon \propto
\begin{bmatrix}
2 b \\
d - a \pm \sqrt{ (d - a)^2 + 4 b c }
\end{bmatrix}.
}

\paragraph{Square lattice}

There is not too much to gain by expanding out the projection operators explicitly in general.  However, let's do this for the specific case of a square lattice (as on the exam problem).  In that case, our projection operators are

\begin{subequations}
\begin{equation}\label{eqn:oneAtomBasisPhonon:260}
\acap \acap^\T
=
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\begin{bmatrix}
1 &
0
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
0 & 0
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:280}
\bcap \bcap^\T
=
\begin{bmatrix}
0\\
1
\end{bmatrix}
\begin{bmatrix}
0 &
1
\end{bmatrix}
=
\begin{bmatrix}
0 & 0 \\
0 & 1
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:300}
\rcap \rcap^\T
=
\inv{2}
\begin{bmatrix}
1 \\
1
\end{bmatrix}
\begin{bmatrix}
1 &
1
\end{bmatrix}
=
\inv{2}
\begin{bmatrix}
1 & 1 \\
1 & 1
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:320}
\scap \scap^\T
=
\inv{2}
\begin{bmatrix}
-1 \\
1
\end{bmatrix}
\begin{bmatrix}
-1 &
1
\end{bmatrix}
=
\inv{2}
\begin{bmatrix}
1 & -1 \\
-1 & 1
\end{bmatrix}
\end{equation}
\end{subequations}


\begin{dmath}\label{eqn:oneAtomBasisPhonon:360}
\begin{aligned}
S_1 &= \sin^2
\lr{ \Ba \cdot \Bq } \\
S_2 &= \sin^2
\lr{ \Bb \cdot \Bq } \\
S_3 &= \sin^2
\lr{ (\Bb + \Ba) \cdot \Bq } \\
S_4 &= \sin^2
\lr{ (\Bb - \Ba) \cdot \Bq },
\end{aligned}
\end{dmath}


Our matrix is

\begin{dmath}\label{eqn:oneAtomBasisPhonon:460}
A =
\frac{2}{m}
\begin{bmatrix}
2 K_1 S_1 + K_3 S_3 + K_4 S_4 & K_3 S_3 - K_4 S_4 \\
K_3 S_3 - K_4 S_4 & 2 K_2 S_2 + K_3 S_3 + K_4 S_4
\end{bmatrix},
\end{dmath}

where, specifically, the squared sines for this geometry are

\begin{subequations}
\begin{equation}\label{eqn:oneAtomBasisPhonon:380}
S_1 = \sin^2
\lr{ \Ba \cdot \Bq/2 }
= \sin^2
\lr{ a q_x/2}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:400}
S_2 = \sin^2
\lr{ \Bb \cdot \Bq/2 } = \sin^2
\lr{ a q_y/2}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:420}
S_3 = \sin^2
\lr{ (\Bb + \Ba) \cdot \Bq/2 }
= \sin^2
\lr{ a (q_x + q_y)/2}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:440}
S_4 = \sin^2
\lr{ (\Bb - \Ba) \cdot \Bq/2 }
= \sin^2
\lr{ a (q_y - q_x)/2}.
\end{equation}
\end{subequations}

Using \eqnref{eqn:oneAtomBasisPhonon:240}, the dispersion relation and eigenvectors are

\begin{subequations}
\begin{dmath}\label{eqn:oneAtomBasisPhonon:520}
\omega^2 =
\frac{2}{m}
\lr{ \sum_i K_i S_i \pm \sqrt{ (K_2 S_2 - K_1 S_1)^2 + (K_3 S_3 - K_4 S_4)^2 } }
\end{dmath}
\begin{dmath}\label{eqn:oneAtomBasisPhonon:540}
\Bepsilon \propto
\begin{bmatrix}
K_3 S_3 - K_4 S_4 \\
K_2 S_2 - K_1 S_1 \pm \sqrt{ (K_2 S_2 - K_1 S_1)^2 + (K_3 S_3 - K_4 S_4)^2 }
\end{bmatrix}.
\end{dmath}
\end{subequations}

This calculation is confirmed in \nbref{oneAtomBasisPhononSquareLatticeEigensystem.nb} .  Mathematica calculates an alternate form (equivalent to using a zero dot product for the second row), of

\begin{dmath}\label{eqn:oneAtomBasisPhonon:920}
\Bepsilon \propto
\begin{bmatrix}
K_1 S_1 - K_2 S_2 \pm \sqrt{ (K_2 S_2 - K_1 S_1)^2 + (K_3 S_3 - K_4 S_4)^2 } \\
K_3 S_3 - K_4 S_4
\end{bmatrix}.
\end{dmath}

Either way, we see that \(K_3 S_3 - K_4 S_4 = 0\) leads to only horizontal or vertical motion.

\paragraph{With the exam criteria}

In the specific case that we had on the exam where \(K_1 = K_2\) and \(K_3 = K_4\), these are

\begin{subequations}
\begin{dmath}\label{eqn:oneAtomBasisPhonon:560}
\omega^2 =
\frac{2}{m}
\lr{ K_1 (S_1 + S_2) + K_3(S_3 + S_4) \pm \sqrt{ K_1^2 (S_2 - S_1)^2 + K_3^2 (S_3 - S_4)^2 } }
\end{dmath}
\begin{dmath}\label{eqn:oneAtomBasisPhonon:580}
\Bepsilon \propto
\begin{bmatrix}
K_3
\lr{ S_3 - S_4 } \\
K_1
\lr{ (S_1 - S_2) \pm \sqrt{ (S_2 - S_1)^2 + \left( \frac{K_3}{K_1} \right)^2 (S_3 - S_4)^2 } }
\end{bmatrix}.
\end{dmath}
\end{subequations}

For horizontal and vertical motion we need \(S_3 = S_4\), or for a \(2 \pi \times \text{integer}\) difference in the absolute values of the sine arguments

\begin{dmath}\label{eqn:oneAtomBasisPhonon:940}
\pm ( a (q_x + q_y) /2 ) = a (q_y - q_y) /2 + 2 \pi n.
\end{dmath}

That is, one of

\begin{dmath}\label{eqn:oneAtomBasisPhonon:960}
\begin{aligned}
q_x &= \frac{2 \pi}{a} n \\
q_y &= \frac{2 \pi}{a} n
\end{aligned}
\end{dmath}

In the first BZ, that is one of \(q_x = 0\) or \(q_y = 0\).

%We see that the cross coupling is required to have a non-zero \(x\) component.  This is likely what our Prof was after, when asking why this cross coupling is required for stability (i.e. without those spring constants we have a diagonal interaction matrix, and completely independent eigenvectors)

\paragraph{System in rotated coordinates}

On the exam, where we were asked to solve for motion along the cross directions explicitly, there was a strong hint to consider a rotated (by \(\pi/4\)) coordinate system.
%We can make a change of variables for the reciprocal coordinates
%
%\begin{subequations}
%\begin{equation}\label{eqn:oneAtomBasisPhonon:600}
%\begin{bmatrix}
%k_u \\
%k_v
%\end{bmatrix}
%=
%\inv{\sqrt{2}}
%\begin{bmatrix}
%1 & 1 \\
%-1 & 1
%\end{bmatrix}
%\begin{bmatrix}
%q_x \\
%q_y
%\end{bmatrix}
%=
%\inv{\sqrt{2}}
%\begin{bmatrix}
%q_y + q_x \\
%q_y - q_x
%\end{bmatrix}
%\end{equation}
%\begin{equation}\label{eqn:oneAtomBasisPhonon:620}
%\begin{bmatrix}
%q_x \\
%q_y
%\end{bmatrix}
%=
%\inv{\sqrt{2}}
%\begin{bmatrix}
%1 & -1 \\
%1 & 1
%\end{bmatrix}
%\begin{bmatrix}
%k_u \\
%k_v
%\end{bmatrix}
%=
%\inv{\sqrt{2}}
%\begin{bmatrix}
%k_u - k_v \\
%k_u + k_v
%\end{bmatrix},
%\end{equation}
%\end{subequations}
The rotated the lattice basis vectors are \(\Ba = a \Be_1, \Bb = a \Be_2\), and the projection matrices.  Writing \(\rcap = \Bf_1\) and \(\scap = \Bf_2\), where \(\Bf_1 = (\Be_1 + \Be_2)/\sqrt{2}, \Bf_2 = (\Be_2 - \Be_1)/\sqrt{2}\), or \(\Be_1 = (\Bf_1 - \Bf_2)/\sqrt{2}, \Be_2 = (\Bf_1 + \Bf_2)/\sqrt{2}\).  In the \(\{\Bf_1, \Bf_2\}\) basis the projection matrices are

\begin{subequations}
\begin{equation}\label{eqn:oneAtomBasisPhonon:660}
\acap \acap^\T =
\inv{2}
\begin{bmatrix}
1 \\
-1
\end{bmatrix}
\begin{bmatrix}
1 &
-1
\end{bmatrix}
= \inv{2}
\begin{bmatrix}
1 & -1 \\
-1 & 1
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:680}
\bcap \bcap^\T =
\inv{2}
\begin{bmatrix}
1 \\
1
\end{bmatrix}
\begin{bmatrix}
1 &
1
\end{bmatrix}
= \inv{2}
\begin{bmatrix}
1 & 1 \\
1 & 1
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:700}
\rcap \rcap^\T =
\begin{bmatrix}
1 & 0 \\
0 & 0
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:720}
\scap \scap^\T =
\begin{bmatrix}
0 & 0 \\
0 & 1
\end{bmatrix}
\end{equation}
\end{subequations}

The dot products that show up in the squared sines are

\begin{subequations}
\begin{equation}\label{eqn:oneAtomBasisPhonon:740}
\Ba \cdot \Bq
=
a \inv{\sqrt{2}} (\Bf_1 - \Bf_2) \cdot (\Bf_1 k_u + \Bf_2 k_v)
=
\frac{a}{\sqrt{2}} (k_u - k_v)
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:760}
\Bb \cdot \Bq
=
a \inv{\sqrt{2}} (\Bf_1 + \Bf_2) \cdot (\Bf_1 k_u + \Bf_2 k_v)
=
\frac{a}{\sqrt{2}} (k_u + k_v)
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:780}
(\Ba + \Bb) \cdot \Bq = \sqrt{2} a k_u
\end{equation}
\begin{equation}\label{eqn:oneAtomBasisPhonon:800}
(\Bb - \Ba) \cdot \Bq = \sqrt{2} a k_v
\end{equation}
\end{subequations}

So that in this basis
\begin{dmath}\label{eqn:oneAtomBasisPhonon:820}
\begin{aligned}
S_1 &= \sin^2
\lr{ \frac{a}{\sqrt{2}} (k_u - k_v) } \\
S_2 &= \sin^2
\lr{ \frac{a}{\sqrt{2}} (k_u + k_v) } \\
S_3 &= \sin^2
\lr{ \sqrt{2} a k_u } \\
S_4 &= \sin^2
\lr{ \sqrt{2} a k_v }
\end{aligned}
\end{dmath}

With the rotated projection operators \eqnref{eqn:oneAtomBasisPhonon:100} takes the form

\begin{dmath}\label{eqn:oneAtomBasisPhonon:840}
A =
\frac{2}{m}
\begin{bmatrix}
K_1 S_1 + K_2 S_2 + 2 K_3 S_3 & K_2 S_2 - K_1 S_1 \\
K_2 S_2 - K_1 S_1 & K_1 S_1 + K_2 S_2 + 2 K_4 S_4
\end{bmatrix}.
\end{dmath}

This clearly differs from \eqnref{eqn:oneAtomBasisPhonon:460}, and results in a different expression for the eigenvectors, but the same as \eqnref{eqn:oneAtomBasisPhonon:520} for the angular frequencies.

\begin{dmath}\label{eqn:oneAtomBasisPhonon:880}
\Bepsilon \propto
\begin{bmatrix}
K_2 S_2
-
K_1 S_1
\\
K_4 S_4 - K_3 S_3
\mp \sqrt{ (K_2 S_2 - K_1 S_1)^2 + (K_3 S_3 - K_4 S_4)^2 }
\end{bmatrix},
\end{dmath}

or, equivalently

\begin{dmath}\label{eqn:oneAtomBasisPhonon:881}
\Bepsilon \propto
\begin{bmatrix}
K_4 S_4 - K_3 S_3 \mp \sqrt{ (K_2 S_2 - K_1 S_1)^2 + (K_3 S_3 - K_4 S_4)^2 } \\
K_1 S_1 - K_2 S_2 \\
\end{bmatrix},
\end{dmath}

For the \(K_1 = K_2\) and \(K_3 = K_4\) case of the exam, this is

\begin{dmath}\label{eqn:oneAtomBasisPhonon:900}
\Bepsilon \propto
\begin{bmatrix}
K_1 (S_2 - S_1 ) \\
K_3
\lr{ S_4 - S_3 \mp \sqrt{ \left( \frac{K_1}{K_3} \right)^2 (S_2 - S_1)^2 + (S_3 - S_4)^2 } }
\end{bmatrix}.
\end{dmath}

Similar to the horizontal coordinate system, we see that we have motion along the diagonals when

\begin{dmath}\label{eqn:oneAtomBasisPhonon:980}
\pm \frac{a}{\sqrt{2}} (k_u - k_v) = \frac{a}{\sqrt{2}} (k_u + k_v) + 2 \pi n,
\end{dmath}

or one of

\begin{dmath}\label{eqn:oneAtomBasisPhonon:1000}
\begin{aligned}
k_u &= \sqrt{2} \frac{\pi}{a} n \\
k_v &= \sqrt{2} \frac{\pi}{a} n
\end{aligned}
\end{dmath}

\paragraph{Stability?}

The exam asked why the cross coupling is required for stability.  Clearly we have more complex interaction.  The constant \(\omega\) surfaces will also be more complex.  However, I still don't have a good intuition what exactly was sought after for that part of the question.

\paragraph{Numerical computations}

A Manipulate allowing for choice of the spring constants and lattice orientation, as shown in \cref{fig:oneAtomBasisPhonon:oneAtomBasisPhononFig2}, is available in \nbref{oneAtomBasisPhonon.nb}.  This interface also provides a numerical calculation of the distribution relation as shown in \cref{fig:oneAtomBasisPhonon:oneAtomBasisPhononFig3}, and provides an animation of the normal modes for any given selection of \(\Bq\) and \(\omega(\Bq)\) (not shown).

\mathImageFigure{../../figures/phy487/oneAtomBasisPhononFig2}{2D Single atom basis Manipulate interface}{fig:oneAtomBasisPhonon:oneAtomBasisPhononFig2}{0.2}{oneAtomBasisLatticeDemo.nb}
\mathImageFigure{../../figures/phy487/oneAtomBasisPhononFig3}{Sample distribution relation for 2D single atom basis.}{fig:oneAtomBasisPhonon:oneAtomBasisPhononFig3}{0.2}{oneAtomBasisLatticeDemo.nb}

} % makeanswer

%\EndArticle
%\EndNoBibArticle
