%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{twoMassHarmonic}
%\renewcommand{\dirname}{notes/phy487/}
%%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{Lagrangian, Harmonic oscillator, center of mass, two body problem}
%
%\newcommand{\nought}[0]{\circ}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Harmonic oscillator and displacement coordinates}
%\chapter{Two body harmonic oscillator in 3D}
%\section{3D harmonic oscillator}
\label{chap:twoMassHarmonic}

%\paragraph{Motivation}
%
%In lattice problems, we consider normal modes of harmonic coupled systems.  Here is a progression through a set of treatments of two harmonically coupled masses, to a lattice configuration with a number of masses all harmonically coupled.

\makeproblem{Two body harmonic oscillator in 3D}{pr:twoMassHarmonic:1}{
Solve a two mass harmonically coupled system without considering any equilibrium separation.
} % makeproblem

\makeanswer{pr:twoMassHarmonic:1}{

For the system illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig1} the Lagrangian is

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig1}{Two masses with harmonic coupling}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig1}{0.2}

\begin{dmath}\label{eqn:twoMassHarmonic:20}
\LL =
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ \Br_2 - \Br_1 }^2.
\end{dmath}

We wish to solve the equations of motion

\begin{dmath}\label{eqn:twoMassHarmonic:40}
\ddt{} \spacegrad_{\dot{\Br}_i} \LL =
\spacegrad_{\Br_i} \LL.
\end{dmath}

Noting that \(\spacegrad_\Bx \Ba \cdot \Bx = \Ba\), the coupled system to solve is

\begin{dmath}\label{eqn:twoMassHarmonic:60}
\begin{aligned}
m_1 \ddot{\Br}_1 &= - K \lr{ \Br_1 - \Br_2 } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Br_2 - \Br_1 }.
\end{aligned}
\end{dmath}

These can be decoupled using differences and sums

\begin{dmath}\label{eqn:twoMassHarmonic:80}
\begin{aligned}
m_1 \lr{ m_2 \ddot{\Br}_2 } - m_2 \lr{ m_1 \ddot{\Br}_1 } &= - (m_1 + m_2) K \lr{ \Br_2 - \Br_1 } \\
m_1 \ddot{\Br}_1 + m_2 \ddot{\Br}_2 &= 0
\end{aligned}
\end{dmath}

The second is the equation for the acceleration of the center of mass \(\BR_{\mathrm{CM}}(t)\).  That center of mass relation is directly integrable.  With \(M = m_1 + m_2\), that is

\begin{dmath}\label{eqn:twoMassHarmonic:100}
M \BR_{\mathrm{CM}}(t)
=
m_1 \Br_1 + m_2 \Br_2 =
 (t - t_\nought)
M \BV_{\mathrm{CM}}
+ M \BR_{\mathrm{CM}}(t_\nought).
\end{dmath}

The first is the harmonic oscillation about the center of mass position.  Introducing the reduced mass

\begin{dmath}\label{eqn:twoMassHarmonic:120}
\mu = \frac{m_1 m_2}{m_1 + m_2},
\end{dmath}

that oscillation equation is

\begin{dmath}\label{eqn:twoMassHarmonic:140}
\frac{d^2}{dt^2}
\lr{ \Br_2 - \Br_1 }
= -\frac{K}{\mu}
\lr{ \Br_2 - \Br_1 }.
\end{dmath}

With angular frequency \(\omega^2 = \frac{K}{\mu}\), vector difference \(\Delta \Br(t) = \Br_2(t) - \Br_1(t)\), and initial time values \(\Delta \Br_\nought = \Delta \Br(t_\nought)\), and \(\Delta \Bv_\nought = \Delta \Br'(t_\nought)\) the solution for \(\Delta \Br(t)\), by inspection, is

\begin{dmath}\label{eqn:twoMassHarmonic:180}
\Delta \Br(t) =
\Delta \Br_\nought \cos\lr{ \omega(t - t_\nought) }
+ \frac{\Delta \Bv_\nought}{\omega} \sin\lr{ \omega(t - t_\nought) }.
\end{dmath}

The reference time can be picked to allow for solutions of arbitrary phase.  For example, for cosine solutions, pick \(t_\nought\) as the time for which the amplitude difference is maximized.

To find for the individual \(\Br_i\) vectors we have only to invert the matrix relation

\begin{dmath}\label{eqn:twoMassHarmonic:200}
\begin{bmatrix}
-1 & 1 \\
m_1 & m_2
\end{bmatrix}
\begin{bmatrix}
\Br_1 \\
\Br_2
\end{bmatrix}
=
\begin{bmatrix}
\Delta \Br(t) \\
M \BR_{\mathrm{CM}}(t)
\end{bmatrix},
\end{dmath}

or

\begin{dmath}\label{eqn:twoMassHarmonic:220}
\begin{bmatrix}
\Br_1 \\
\Br_2
\end{bmatrix}
=
\frac{1}{m_2 + m_1}
\begin{bmatrix}
-m_2 & 1 \\
m_1 & 1
\end{bmatrix}
\begin{bmatrix}
\Delta \Br(t) \\
M \BR_{\mathrm{CM}}(t)
\end{bmatrix}
\end{dmath}

The final solution is

\begin{dmath}\label{eqn:twoMassHarmonic:240}
\begin{aligned}
\Br_1(t) &=
-\frac{\mu}{m_1}
\Delta \Br(t)
+ \BR_{\mathrm{CM}}(t) \\
\Br_2(t) &=
\frac{\mu}{m_2}
\Delta \Br(t)
+ \BR_{\mathrm{CM}}(t)
\end{aligned}
\end{dmath}

Looking at this, it appears non-sensical.  At the very least, it is unphysical, and allows the masses to pass through each other.  This is illustrated in the animation of \nbref{harmonicOscillatorTwoMasses.cdf}

Our Lagrangian needs to model the equilibrium length of the spring.

}

\makeproblem{1D system with non-zero equilibrium length}{pr:twoMassHarmonic:2}{

In the absence of any initial angular momentum, the problem previously considered is essentially one dimensional.

Let's consider a physically realistic harmonic oscillator system, with coupling that is relative to an equilibrium length (the length of an uncompressed or unstretched spring for example).  That system is illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig2}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig2}{Linear harmonic coupling with equilibrium length}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig2}{0.1}
} % makeproblem

\makeanswer{pr:twoMassHarmonic:2}{

Adjusting for a rest length \(a = a_2 - a_1\) for the spring, the new system is described by

\begin{dmath}\label{eqn:twoMassHarmonic:22}
\LL =
\inv{2} m_1 \lr{ \dot{x}_1 }^2
+\inv{2} m_2 \lr{ \dot{x}_2 }^2
- \frac{K}{2} \lr{ x_2 - x_1 - a }^2.
\end{dmath}

Now our equations of motion are

\begin{dmath}\label{eqn:twoMassHarmonic:61}
\begin{aligned}
m_1 \ddot{x}_1 &= - K \lr{ x_1 - x_2 + a } \\
m_2 \ddot{x}_2 &= - K \lr{ x_2 - x_1 - a }.
\end{aligned}
\end{dmath}

With \(u = x_2 - x_1 - a\), this is

\begin{dmath}\label{eqn:twoMassHarmonic:260}
\ddot{u} = -\frac{K}{\mu} u.
\end{dmath}

Solving and back substituting for \(\Delta x(t) = x_2(t) - x_1(t)\), we have

\begin{dmath}\label{eqn:twoMassHarmonic:280}
\Delta x(t)
=
a +
\lr{ \Delta x(0) - a } \cos\omega t
+
\frac{ \Delta v(0) }{\omega} \sin\omega t.
\end{dmath}

Note that this does not model collision effects, should the initial position or velocity be sufficient to bring the masses into contact.
} % makeanswer

\makeproblem{3D system with non-zero equilibrium length}{pr:twoMassHarmonic:3}{
Derive the equations of motion for a 3D harmonically coupled system with a non-zero equilibrium length using a Lagrange multiplier to enforce a linear constraint.
} % makeproblem

\makeanswer{pr:twoMassHarmonic:3}{
The geometric of a 3D harmonically coupled system with a non-zero equilibrium length is sketched in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig3}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig3}{Two mass harmonic coupled system}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig3}{0.2}

We can model the coupling spring as a line segment colinear with the difference vector, or

\begin{dmath}\label{eqn:twoMassHarmonic:21}
\LL =
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ \Delta \Br - \Ba }^2
+ \lambda \lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2.
\end{dmath}

A Lagrange multiplier \(\lambda\) is used to enforce a requirement that the difference vector \(\Delta \Br\) is colinear with \(\Ba\) (i.e. zero component perpendicular to the projection along \(\acap\).)

The rejection square expands as

\begin{dmath}\label{eqn:twoMassHarmonic:300}
\lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2
=
\lr{ \Delta \Br }^2
- 2 \lr{\acap \cdot \Delta \Br}^2
+ \lr{\acap \cdot \Delta \Br}^2
=
\lr{ \Delta \Br }^2
- \lr{\acap \cdot \Delta \Br}^2
\end{dmath}

The Euler-Lagrange equations expand as

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:320}
m_1 \ddot{\Br}_1 = K \lr{ \Delta \Br - \Ba } - 2 \lr{ \Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap }
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:340}
m_2 \ddot{\Br}_2 = - K \lr{ \Delta \Br - \Ba } + 2 \lr{ \Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap }
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:360}
0 = \lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2
\end{dmath}
\end{subequations}

\Eqnref{eqn:twoMassHarmonic:360} indicates that the norm of the rejection is zero, so that rejection is also zero \(\Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap = 0\).  This kills off the \(\lambda\) terms, leaving just

\begin{dmath}\label{eqn:twoMassHarmonic:380}
\begin{aligned}
m_1 \ddot{\Br}_1 &= K \lr{ \Delta \Br - \Ba } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Delta \Br - \Ba }.
\end{aligned}
\end{dmath}

Taking differences this is

\begin{dmath}\label{eqn:twoMassHarmonic:400}
\Delta \ddot{\Br} = - \frac{K}{\mu} \lr{ \Delta \Br - \Ba }.
\end{dmath}

By inspection the solution for the difference is

\begin{dmath}\label{eqn:twoMassHarmonic:420}
\Delta \Br(t) =
\Ba
+
\lr{ \Delta \Br_\nought - \Ba } \cos\lr{ \omega(t - t_\nought) }
+ \frac{\Delta \Bv_\nought}{\omega} \sin\lr{ \omega(t - t_\nought) }.
\end{dmath}

with the individual mass position vectors still given by \eqnref{eqn:twoMassHarmonic:240}.

We get a strong hint here why we wish to work with displacement coordinates.
%Once we do so, there's no longer any requirement to include the Lagrange multipliers that specify the physical constraint.
} % makeanswer

\makeproblem{A different formulation of the equilibrium position constraint}{pr:twoMassHarmonic:4}{
Without the use of the somewhat forced seeming direction constraint used above, rederive the equations of motion.
} % makeproblem

\makeanswer{pr:twoMassHarmonic:4}{
Here's a more natural way of specifying that we have an equilibrium length constraint

\begin{dmath}\label{eqn:twoMassHarmonic:440}
\LL
=
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{
\Abs{\Br_2 - \Br_1} - a
}^2
=
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{
\lr{\Br_2 - \Br_1}^2 - 2 a \Abs{\Br_2 - \Br_1} + a^2
}.
\end{dmath}

The evaluation of the absolute value gradient in the Euler-Lagrange equations can be done implicitly, computing the absolute square gradient in two different ways

\begin{subequations}
\begin{equation}\label{eqn:twoMassHarmonic:460}
\PD{\Bx}{\Abs{\Bx}^2}
=
\PD{\Bx}{\Bx^2}
=
2 \Bx
\end{equation}
\begin{equation}\label{eqn:twoMassHarmonic:480}
\PD{\Bx}{\Abs{\Bx}^2}
=
2 \Abs{\Bx} \PD{\Bx}{\Abs{\Bx}},
\end{equation}
\end{subequations}

so that
\begin{dmath}\label{eqn:twoMassHarmonic:500}
\PD{\Bx}{\Abs{\Bx}} = \frac{\Bx}{\Abs{\Bx}}.
\end{dmath}

This gives us

\begin{dmath}\label{eqn:twoMassHarmonic:520}
\begin{aligned}
m_1 \ddot{\Br}_1 &= - K \lr{ \Br_1 - \Br_2 - a \frac{\Br_1 - \Br_2}{\Abs{\Br_2 - \Br_1}} } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Br_2 - \Br_1 - a \frac{\Br_2 - \Br_1}{\Abs{\Br_2 - \Br_1}} }
\end{aligned}
\end{dmath}

With \(\Delta \Br = \Br_2 - \Br_1\) and \(\hat{\Delta}_{21} = \lr{\Br_2 - \Br_1}/\Abs{\Br_2 - \Br_1}\), this gives

\boxedEquation{eqn:twoMassHarmonic:540}{
\mu \Delta \ddot{\Br} = - K \lr{ \Delta \Br - a \hat{\Delta}_{2 1} }.
}

In general, \(\hat{\Delta}_{2 1}\) could rotate in space (non-zero angular momentum for the system), meaning that we'd also have a directional dependence on the LHS.  A specific solution is possible if we assume that the direction is fixed, and introduce scalar displacement coordinates, relative to the center of the equilibrium position as illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig4}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig4}{Coupling directed along difference vector}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig4}{0.2}

\begin{dmath}\label{eqn:twoMassHarmonic:560}
\begin{aligned}
\Br_1 &= \lr{ -\frac{a}{2} + u_1 } \hat{\Delta}_{2 1} \\
\Br_2 &= \lr{ \frac{a}{2} + u_2 } \hat{\Delta}_{2 1}.
\end{aligned}
\end{dmath}

With \(\Delta u = u_2 - u_1\), \eqnref{eqn:twoMassHarmonic:540} takes the form

\begin{dmath}\label{eqn:twoMassHarmonic:580}
\mu \Delta \ddot{u} = - K \Delta u.
\end{dmath}

We see exactly how natural displacement coordinates are for the two mass problem.  We have also avoided the awkward requirement for a Lagrange multiplier constraint in the Lagrangian model of the system.
} % makeanswer

\makeproblem{Linearized potential about equilibrium point}{pr:twoMassHarmonic:5}{
Compute the linear expansion of a two mass potential, with masses located at \(\Br_1, \Br_2\) and equilibrium positions \(\Ba_1, \Ba_2\).
} % makeproblem

\makeanswer{pr:twoMassHarmonic:5}{
\begin{dmath}\label{eqn:twoMassHarmonic:600}
\phi(\Br_1, \Br_2)
=
\frac{K}{2} \lr{ \Abs{\Br_2 - \Br_1} - \Abs{\Ba_2 - \Ba_1} }^2
=
\frac{K}{2} \lr{
\lr{\Br_2 - \Br_1}^2
- 2 \Abs{\Ba_2 - \Ba_1} \Abs{\Br_2 - \Br_1}
+ \lr{\Ba_2 - \Ba_1}^2
}.
\end{dmath}

With \(\Delta \Ba = \Ba_2 - \Ba_1\), and \(\Br_k = \sum_i \Be_i r_{ki}\), this has first derivatives

\begin{dmath}\label{eqn:twoMassHarmonic:620}
\PD{r_{1i}}{\phi}
=
K \lr{
\lr{\Br_1 - \Br_2} \cdot \Be_i
- \Abs{\Ba_2 - \Ba_1} \frac{ r_{1i} - r_{2i} }{ \Abs{\Br_2 - \Br_1} }
}
\end{dmath}

Regrouping and noting the \(\Br_2, \Br_1\) swapping symmetry, these first derivatives are

\begin{dmath}\label{eqn:twoMassHarmonic:640}
\begin{aligned}
\PD{r_{1i}}{\phi}
&=
K
\lr{
r_{1i} - r_{2i}
}
\lr{
1 -
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} }
} \\
\PD{r_{2i}}{\phi}
&=
K
\lr{
r_{2i} - r_{1i}
}
\lr{
1 -
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} }
}.
\end{aligned}
\end{dmath}

At the equilibrium positions \(\Ba_1, \Ba_2\), the first order derivatives are all zero for this potential, a property used in the equilibrium potential expansion discussions of \citep{ibach2009solid} and \citep{ashcroft1976solid}.  Proceeding to calculate the second derivatives

\begin{dmath}\label{eqn:twoMassHarmonic:660}
\PD{r_{1j}}{}
\PD{r_{1i}}{\phi}
=
K
\delta_{i j}
\lr{
1 -
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} }
}
-
K
\lr{
r_{1i} - r_{2i}
}
\Abs{\Ba_2 - \Ba_1}
\PD{r_{1j}}{}
\lr{ \lr{\Br_1 - \Br_2}^2 }^{-1/2}
=
K
\delta_{i j}
\lr{
1 -
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} }
}
+
K
\lr{
r_{1i} - r_{2i}
}
\Abs{\Ba_2 - \Ba_1}
\frac
{2 \lr{ r_{1j} - r_{2j} }
}
{2 \Abs{\Br_1 - \Br_2}^3 }
\end{dmath}

At the equilibrium positions, this is

\begin{dmath}\label{eqn:twoMassHarmonic:680}
\evalbar{
\PD{r_{1j}}{}
\PD{r_{1i}}{\phi}
}{\Ba_1, \Ba_2}
=
+K
\frac{\Delta a_i}{\Abs{\Delta \Ba}}
\frac{\Delta a_j}{\Abs{\Delta \Ba}}.
\end{dmath}

These ratios are the direction cosines, as illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig5}, where \(\Delta \Ba = \Abs{\Delta \Ba} \lr{\cos \theta_1, \cos\theta_2, \cos\theta_3}\).  Again employing symmetries, the second derivatives for the non-mixed coordinates are

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig5}{Direction cosines relative to equilibrium position difference vector}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig5}{0.3}

\begin{dmath}\label{eqn:twoMassHarmonic:700}
\begin{aligned}
\evalbar{
\PD{r_{1j}}{}
\PD{r_{1i}}{\phi}
}{\Ba_1, \Ba_2}
&=
K \cos\theta_i \cos\theta_j \\
\evalbar{
\PD{r_{2j}}{}
\PD{r_{2i}}{\phi}
}{\Ba_1, \Ba_2}
&=
K \cos\theta_i \cos\theta_j.
\end{aligned}
\end{dmath}

For the mixed derivatives

\begin{dmath}\label{eqn:twoMassHarmonic:661}
\PD{r_{2j}}{}
\PD{r_{1i}}{\phi}
=
-K
\delta_{i j}
\lr{
1 -
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} }
}
-
K
\lr{
r_{1i} - r_{2i}
}
\Abs{\Ba_2 - \Ba_1}
\PD{r_{2j}}{}
\lr{ \lr{\Br_2 - \Br_1}^2 }^{-1/2}
=
-K
\delta_{i j}
\lr{
1 -
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} }
}
+
K
\lr{
r_{1i} - r_{2i}
}
\Abs{\Ba_2 - \Ba_1}
\frac
{2 \lr{ r_{2j} - r_{1j} }
}
{2 \Abs{\Br_1 - \Br_2}^3 }.
\end{dmath}

At the equilibrium positions, this is

\begin{equation}\label{eqn:twoMassHarmonic:720}
\evalbar{
\PD{r_{2j}}{}
\PD{r_{1i}}{\phi}
}{\Ba_1, \Ba_2}
=
\evalbar{
\PD{r_{1j}}{}
\PD{r_{2i}}{\phi}
}{\Ba_1, \Ba_2}
=
-K \cos\theta_i \cos\theta_j,
\end{equation}

so to second order, with displacement coordinates \(\Bu_i = \Br_i - \Ba_i\), the potential is

\begin{dmath}\label{eqn:twoMassHarmonic:740}
\phi(\Bu_1, \Bu_2)
\approx
\phi(\Ba_1, \Ba_2)
+
\frac{K}{2} \sum_{i j} \cos\theta_i \cos\theta_j \lr{
  u_{1j} u_{1i}
- u_{2j} u_{1i}
- u_{1j} u_{2i}
+ u_{2j} u_{2i}
},
\end{dmath}

but since \(\phi(\Ba_1, \Ba_2) = 0\), we have

\boxedEquation{eqn:twoMassHarmonic:760}{
\phi(\Bu_1, \Bu_2)
\approx
\frac{K}{2} \sum_{i j} \cos\theta_i \cos\theta_j
\lr{ u_{2 i} - u_{1 i} }
\lr{ u_{2 j} - u_{1 j} }.
}

As a check observe that if \(\Delta \Ba\) is directed along \(\Be_1\), we have to second order \(\phi(\Bu_1, \Bu_2) = \frac{K}{2} \lr{ u_{2 1} - u_{1 1} }^2\), as we found previously.

The complete Lagrangian is, to second order about the equilibrium positions,

\begin{dmath}\label{eqn:twoMassHarmonic:780}
\LL =
\sum_j \frac{m_i}{2} \dot{u}_{ij}^2
-
\frac{K}{2} \sum_{i j}
\cos\theta_i \cos\theta_j
\lr{ u_{2 i} - u_{1 i} }
\lr{ u_{2 j} - u_{1 j} }.
\end{dmath}

Evaluating the Euler-Lagrange equations for \(m_2\) we have

\begin{dmath}\label{eqn:twoMassHarmonic:800}
\ddt{} \PD{\dot{u}_{2k}}{\LL}
=
m_2 \ddot{u}_{2k}.
\end{dmath}

With \(\hat{\Delta}_{21} = \Delta \Ba/\Abs{\Delta \Ba}\), the position derivatives are

\begin{dmath}\label{eqn:twoMassHarmonic:820}
\PD{u_{2k}}{\LL}
=
- \frac{K}{2} \sum_{ij}
\cos\theta_i \cos\theta_j
\lr{
\delta_{i k} \lr{ u_{2 j} - u_{1 j} }
+
\lr{ u_{2 i} - u_{1 i} }
\delta_{j k}
}
=
- K \sum_{j}
\cos\theta_k \cos\theta_j
\lr{
u_{2 j} - u_{1 j}
}
=
-K
\cos\theta_k
\hat{\Delta}_{2 1} \cdot \Delta \Bu.
\end{dmath}

The vector form of the Euler-Lagrange equations \(d/dt(\PDi{\dot{\Bu}_i}{\LL}) = \PDi{\Bu_i}{\LL}\), is by inspection
\begin{dmath}\label{eqn:twoMassHarmonic:840}
\begin{aligned}
m_1 \ddot{\Bu}_1 &= K \hat{\Delta}_{2 1} \lr{ \hat{\Delta}_{2 1} \cdot \Delta \Bu } \\
m_2 \ddot{\Bu}_2 &= -K \hat{\Delta}_{2 1} \lr{ \hat{\Delta}_{2 1} \cdot \Delta \Bu },
\end{aligned}
\end{dmath}

or

\boxedEquation{eqn:twoMassHarmonic:860}{
\begin{aligned}
\mu \Delta \ddot{\Bu} &= -K \hat{\Delta}_{2 1} \lr{ \hat{\Delta}_{2 1} \cdot \Delta \Bu } \\
m_1 \ddot{\Bu}_1 + m_2 \ddot{\Bu}_2 &= 0.
\end{aligned}
}

Observe that on the RHS above we have a projection operator, so we could also write

\begin{dmath}\label{eqn:twoMassHarmonic:880}
\mu \Delta \ddot{\Bu} = -K \Proj_{\hat{\Delta}_{2 1}} \Delta \Bu.
\end{dmath}

Only the portion of the displacement difference \(\Delta \Bu\) that is directed along the equilibrium line contributes to the acceleration of the displacement difference.
} % makeanswer

\makeproblem{A number of harmonically coupled masses}{pr:twoMassHarmonic:6}{

Now let's consider masses at lattice points indexed by a lattice vector \(\Bn\), as illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig6}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig6}{Masses harmonically coupled in a lattice}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig6}{0.3}

} % makeproblem

\makeanswer{pr:twoMassHarmonic:6}{

With a coupling constant of \(K_{\Bn \Bm}\) between lattice points indexed \(\Bn\) and \(\Bm\) (located at \(\Ba_\Bn\) and \(\Ba_\Bm\) respectively), and direction cosines for the equilibrium direction vector between those points given by

\begin{dmath}\label{eqn:twoMassHarmonic:900}
\Ba_\Bn - \Ba_\Bm
= \Delta \Ba_{\Bn \Bm}
= \Abs{\Delta \Ba_{\Bn \Bm}} (
\cos \theta_{\Bn \Bm 1},
\cos \theta_{\Bn \Bm 2},
\cos \theta_{\Bn \Bm 3}
),
\end{dmath}

the Lagrangian is

\begin{dmath}\label{eqn:twoMassHarmonic:920}
\LL
= \sum_{\Bn, i} \frac{m_\Bn}{2} \dot{u}_{\Bn i}^2
-\inv{2} \sum_{\Bn \ne \Bm, i, j}
\frac{K_{\Bn \Bm}}{2}
\cos\theta_{\Bn \Bm i}
\cos\theta_{\Bn \Bm j}
\lr{
u_{\Bn i} - u_{\Bm i}
}
\lr{
u_{\Bn j} - u_{\Bm j}
}
\end{dmath}

Evaluating the Euler-Lagrange equations for the mass at index \(\Bn\) we have

\begin{dmath}\label{eqn:twoMassHarmonic:940}
\ddt{} \PD{\dot{u}_{\Bn k}}{\LL}
=
m_\Bn \ddot{u}_{\Bn k},
\end{dmath}

and

\begin{dmath}\label{eqn:twoMassHarmonic:960}
\PD{u_{\Bn k}}{\LL}
=
-\sum_{\Bm, i, j}
\frac{K_{\Bn \Bm}}{2}
\cos\theta_{\Bn \Bm i}
\cos\theta_{\Bn \Bm j}
\lr{
\delta_{i k}
\lr{ u_{\Bn j} - u_{\Bm j} }
+
\lr{ u_{\Bn i} - u_{\Bm i} }
\delta_{j k}
}
=
-\sum_{\Bm, i}
K_{\Bn \Bm}
\cos\theta_{\Bn \Bm k}
\cos\theta_{\Bn \Bm i}
\lr{ u_{\Bn i} - u_{\Bm i} }
=
-\sum_{\Bm}
K_{\Bn \Bm}
\cos\theta_{\Bn \Bm k}
\hat{\Delta}_{\Bn \Bm} \cdot \Delta \Bu_{\Bn \Bm},
\end{dmath}

where \(\Delta \Bu_{\Bn \Bm} = \Bu_\Bn - \Bu_\Bm\).  Equating both, we have in vector form

\begin{dmath}\label{eqn:twoMassHarmonic:980}
m_\Bn \ddot{\Bu}_\Bn
=
-\sum_{\Bm}
K_{\Bn \Bm}
\hat{\Delta}_{\Bn \Bm}
\lr{ \hat{\Delta}_{\Bn \Bm} \cdot \Delta \Bu_{\Bn \Bm} },
\end{dmath}

or
\boxedEquation{eqn:twoMassHarmonic:1000}{
m_\Bn \ddot{\Bu}_\Bn
=
-\sum_{\Bm}
K_{\Bn \Bm}
\Proj_{ \hat{\Delta}_{\Bn \Bm} } \Delta \Bu_{\Bn \Bm},
}

This is an intuitively pleasing result.  We have displacement and the direction of the lattice separations in the mix, but not the magnitude of the lattice separation itself.  Compare that to \eqnref{eqn:twoMassHarmonic:540} (the two mass result that did not use the Taylor expansion of the potential), where we had the lattice spacing explicitly along with the absolute coordinates (or rather the difference between them).
} % makeanswer

\makeproblem{Two atom basis, 2D diamond lattice}{pr:twoMassHarmonic:7}{
As a concrete application of the previously calculated equilibrium harmonic oscillator result, find the equations of motion for a two atom basis diamond lattice where the horizontal length is \(a\) and vertical height is \(b\).
} % makeproblem

\makeanswer{pr:twoMassHarmonic:7}{
%The basic interaction geometry is illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig7}, with
Indexing for the primitive unit cells is illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig8}.

%\imageFigure{../../figures/phy487/twoMassSpringCouplingFig7}{Diamond lattice}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig7}{0.3}
\imageFigure{../../figures/phy487/twoMassSpringCouplingFig8}{Primitive unit cells for diamond lattice}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig8}{0.3}

Let's write

\begin{dmath}\label{eqn:twoMassHarmonic:1020}
\begin{aligned}
%\Br &= (a, b) \\
%\Bs &= (-a, b) \\
\Br &= a (\cos\theta, \sin\theta) = a \rcap \\
%\Bs &= (-a, b) \\
\Bs &= a (-\cos\theta, \sin\theta) = a \scap \\
%r &= \sqrt{a^2 + b^2} \\
%\rcap &= (a, b)/r \\
%\scap &= (-a, b)/r \\
\Bn &= (n_1, n_2) \\
\Br_\Bn &= n_1 \Br + n_2 \Bs,
\end{aligned}
\end{dmath}

For mass \(m_\alpha, \alpha \in \{1, 2\}\) assume a trial solution of the form

\begin{dmath}\label{eqn:twoMassHarmonic:1040}
\Bu_{\Bn,\alpha} = \frac{\Bepsilon_\alpha(\Bq)}{\sqrt{m_\alpha}} e^{i \Br_n \cdot \Bq - \omega t}.
\end{dmath}

The equations of motion for the two particles are

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:1140}
\begin{aligned}
m_1 \ddot{\Bu}_{\Bn, 1}
&=
- K_1
\Proj_\xcap
\lr{
\Bu_{\Bn, 1} - \Bu_{\Bn - (0,1), 2}
}
- K_1
\Proj_\xcap
\lr{
\Bu_{\Bn, 1} - \Bu_{\Bn - (1,0), 2}
}
\\ &\quad
- K_2
\Proj_\ycap
\lr{
\Bu_{\Bn, 1} - \Bu_{\Bn, 2}
}
- K_2
\Proj_\ycap
\lr{
\Bu_{\Bn, 1} - \Bu_{\Bn - (1,1), 2}
}
\\ &\quad
- K_3
\sum_\pm
\Proj_\rcap
\lr{
\Bu_{\Bn, 1} - \Bu_{\Bn \pm (1,0), 1}
}
- K_4
\sum_\pm
\Proj_\scap
\lr{
\Bu_{\Bn, 1} - \Bu_{\Bn \pm (0,1), 1}
}
\end{aligned}
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1160}
\begin{aligned}
m_2 \ddot{\Bu}_{\Bn, 2} &=
- K_1
\Proj_\xcap
\lr{
\Bu_{\Bn, 2} - \Bu_{\Bn + (1,0), 1}
}
- K_1
\Proj_\xcap
\lr{
\Bu_{\Bn, 2} - \Bu_{\Bn + (0,1), 1}
}
\\ &\quad
- K_2
\Proj_\ycap
\lr{
\Bu_{\Bn, 2} - \Bu_{\Bn, 1}
}
- K_2
\Proj_\ycap
\lr{
\Bu_{\Bn, 2} - \Bu_{\Bn + (1,1), 1}
}
\\ &\quad
- K_3
\sum_\pm
\Proj_\rcap
\lr{
\Bu_{\Bn, 2} - \Bu_{\Bn \pm (1,0), 2}
}
- K_4
\sum_\pm
\Proj_\scap
\lr{
\Bu_{\Bn, 2} - \Bu_{\Bn \pm (0,1), 2}
}
\end{aligned}
\end{dmath}
\end{subequations}

Insertion of the trial solution gives

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:1180}
\begin{aligned}
 \omega^2 \sqrt{m_1} \Bepsilon_1
&=
K_1
\Proj_\xcap
\lr{
\frac{\Bepsilon_1}{\sqrt{m_1}} - \frac{\Bepsilon_2}{\sqrt{m_2}} e^{ - i \Bs \cdot \Bq }
}
+ K_1
\Proj_\xcap
\lr{
\frac{\Bepsilon_1}{\sqrt{m_1}} - \frac{\Bepsilon_2}{\sqrt{m_2}} e^{ - i \Br \cdot \Bq }
}
\\ &\quad
+ K_2
\Proj_\ycap
\lr{
\frac{\Bepsilon_1}{\sqrt{m_1}} - \frac{\Bepsilon_2}{\sqrt{m_2}}
}
+ K_2
\Proj_\ycap
\lr{
\frac{\Bepsilon_1}{\sqrt{m_1}} - \frac{\Bepsilon_2}{\sqrt{m_2}} e^{ - i (\Br + \Bs) \cdot \Bq }
}
\\ &\quad
+ K_3
\lr{ \Proj_\rcap \frac{\Bepsilon_1}{\sqrt{m_1}} }
\sum_\pm
\lr{
1 - e^{ \pm i \Br \cdot \Bq }
}
+ K_4
\lr{ \Proj_\scap \frac{\Bepsilon_1}{\sqrt{m_1}} }
\sum_\pm
\lr{
1 - e^{ \pm i \Bs \cdot \Bq }
}
\end{aligned}
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1200}
\begin{aligned}
\omega^2 \sqrt{m_2} \Bepsilon_2
&=
K_1
\Proj_\xcap
\lr{
\frac{\Bepsilon_2}{\sqrt{m_2}} - \frac{\Bepsilon_1}{\sqrt{m_1}} e^{ + i \Br \cdot \Bq }
}
+ K_1
\Proj_\xcap
\lr{
\frac{\Bepsilon_2}{\sqrt{m_2}} - \frac{\Bepsilon_1}{\sqrt{m_1}} e^{ + i \Bs \cdot \Bq }
}
\\ &\quad
+ K_2
\Proj_\ycap
\lr{
\frac{\Bepsilon_2}{\sqrt{m_2}} - \frac{\Bepsilon_1}{\sqrt{m_1}}
}
+ K_2
\Proj_\ycap
\lr{
\frac{\Bepsilon_2}{\sqrt{m_2}} - \frac{\Bepsilon_1}{\sqrt{m_1}} e^{ + i (\Br + \Bs) \cdot \Bq }
}
\\ &\quad
+ K_3
\lr{ \Proj_\rcap \frac{\Bepsilon_2}{\sqrt{m_2}} }
\sum_\pm
\lr{
1 - e^{ \pm i \Br \cdot \Bq }
}
+ K_4
\lr{ \Proj_\scap \frac{\Bepsilon_2}{\sqrt{m_2}} }
\sum_\pm
\lr{
1 - e^{ \pm i \Bs \cdot \Bq }
}
\end{aligned}
\end{dmath}
\end{subequations}

Regrouping, and using the matrix form \(\Proj_\ucap = \ucap \ucap^\T\) for the projection operators, this is

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:1220}
\lr{
\omega^2 - \frac{2}{m_1}
\lr{
K_1 \xcap \xcap^T
+ K_2 \ycap \ycap^T
+ 2 K_3 \rcap \rcap^T \sin^2 (\Br \cdot \Bq/2)
+ 2 K_4 \scap \scap^T \sin^2 (\Bs \cdot \Bq/2)
}
}
\Bepsilon_1
=
-\lr{
   K_1
   \rcap \rcap^\T
   \lr{
   e^{ - i \Bs \cdot \Bq }
   +
   e^{ - i \Br \cdot \Bq }
   }
+
   K_2
   \scap \scap^\T
   \lr{
   1
   +
   e^{ - i (\Br + \Bs) \cdot \Bq }
   }
}
\frac{\Bepsilon_2}{\sqrt{ m_1 m_2 }}
\end{dmath}
%\begin{dmath}\label{eqn:twoMassHarmonic:1240}
%\begin{aligned}
%\omega^2 \Bepsilon_2
%&=
%K_1
%\xcap \xcap^\T
%\lr{
%\frac{\Bepsilon_2}{m_2} - \frac{\Bepsilon_1}{\sqrt{ m_1 m_2 }} e^{ + i \Br \cdot \Bq }
%}
%+ K_1
%\xcap \xcap^\T
%\lr{
%\frac{\Bepsilon_2}{m_2} - \frac{\Bepsilon_1}{\sqrt{ m_1 m_2 }} e^{ + i \Bs \cdot \Bq }
%}
%\\ &\quad
%+ K_2
%\ycap \ycap^\T
%\lr{
%\frac{\Bepsilon_2}{m_2} - \frac{\Bepsilon_1}{\sqrt{ m_1 m_2 }}
%}
%+ K_2
%\ycap \ycap^\T
%\lr{
%\frac{\Bepsilon_2}{m_2} - \frac{\Bepsilon_1}{\sqrt{ m_1 m_2 }} e^{ + i (\Br + \Bs) \cdot \Bq }
%}
%\\ &\quad
%+ K_3
%\lr{ \rcap \rcap^\T \frac{\Bepsilon_2}{m_2} }
%\sum_\pm
%\lr{
%1 - e^{ \pm i \Br \cdot \Bq }
%}
%+ K_4
%\lr{ \scap \scap^\T \frac{\Bepsilon_2}{m_2} }
%\sum_\pm
%\lr{
%1 - e^{ \pm i \Bs \cdot \Bq }
%}
%\end{aligned}
%\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1260}
\lr{
\omega^2 - \frac{2}{m_2}
\lr{
K_1 \xcap \xcap^T
+ K_2 \ycap \ycap^T
+ 2 K_3 \rcap \rcap^T \sin^2 (\Br \cdot \Bq/2)
+ 2 K_4 \scap \scap^T \sin^2 (\Bs \cdot \Bq/2)
}
}
\Bepsilon_2
=
-\lr{
   K_1
   \rcap \rcap^\T
   \lr{
   e^{ i \Bs \cdot \Bq }
   +
   e^{ i \Br \cdot \Bq }
   }
+
   K_2
   \scap \scap^\T
   \lr{
   1
   +
   e^{ i (\Br + \Bs) \cdot \Bq }
   }
}
\frac{\Bepsilon_1}{\sqrt{ m_1 m_2 }}
\end{dmath}
\end{subequations}

As a single matrix equation, this is
\begin{subequations}
\label{eqn:twoMassHarmonic:1280a}
\begin{dmath}\label{eqn:twoMassHarmonic:1280}
A =
K_1 \xcap \xcap^T
+ K_2 \ycap \ycap^T
+ 2 K_3 \rcap \rcap^T \sin^2 (\Br \cdot \Bq/2)
+ 2 K_4 \scap \scap^T \sin^2 (\Bs \cdot \Bq/2)
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1300}
B =
e^{ i (\Br + \Bs) \cdot \Bq/2 }
\lr{
   K_1
   \rcap \rcap^\T
   \cos\lr{ (\Br - \Bs) \cdot \Bq/2 }
+
   K_2
   \scap \scap^\T
   \cos\lr{ (\Br + \Bs) \cdot \Bq/2 }
}
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1320}
0 =
\begin{bmatrix}
\omega^2 - \frac{2 A}{m_1} & \frac{B^\conj}{\sqrt{m_1 m_2}} \\
\frac{B}{\sqrt{m_1 m_2}} & \omega^2 - \frac{2 A}{m_2}
\end{bmatrix}
\begin{bmatrix}
\Bepsilon_1 \\
\Bepsilon_2
\end{bmatrix}
\end{dmath}
\end{subequations}

Observe that this is an eigenvalue problem \(E \Be = \omega^2 \Be\) for matrix

\begin{dmath}\label{eqn:twoMassHarmonic:1061}
E =
\begin{bmatrix}
\frac{2 A}{m_1} & -\frac{B^\conj}{\sqrt{m_1 m_2}} \\
-\frac{B}{\sqrt{m_1 m_2}} & \frac{2 A}{m_2}
\end{bmatrix},
\end{dmath}

and eigenvalues \(\omega^2\).

To be explicit lets put the \(A\) and \(B\) functions in explicit matrix form.  The orthogonal projectors have a simple form

\begin{subequations}
\begin{equation}\label{eqn:twoMassHarmonic:1060}
\Proj_\xcap
= \xcap \xcap^\T
=
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\begin{bmatrix}
1 & 0
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
0 & 0
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:twoMassHarmonic:1080}
\Proj_\ycap
= \ycap \ycap^\T
=
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\begin{bmatrix}
0 & 1
\end{bmatrix}
=
\begin{bmatrix}
0 & 0 \\
0 & 1
\end{bmatrix}
\end{equation}
\end{subequations}

For the \(\rcap\) and \(\scap\) projection operators, we can use half angle formulations
% writing \(\cos\theta = a/r\), and \(\sin\theta = b/r\)

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:1100}
\Proj_\rcap
= \rcap \rcap^\T
=
%\inv{a^2 + b^2}
\begin{bmatrix}
\cos\theta \\
\sin\theta
\end{bmatrix}
\begin{bmatrix}
\cos\theta & \sin\theta
\end{bmatrix}
%=
%\inv{a^2 + b^2}
%\begin{bmatrix}
%a^2 & a b \\
%a b & b^2
%\end{bmatrix}
=
\begin{bmatrix}
\cos^2\theta & \cos\theta \sin\theta \\
\cos\theta \sin\theta & \sin^2 \theta
\end{bmatrix}
=
\inv{2}
\begin{bmatrix}
1 + \cos \lr{ 2 \theta } & \sin \lr{ 2 \theta } \\
\sin \lr{ 2 \theta } & 1 - \cos \lr{ 2 \theta }
\end{bmatrix}
%=
%\inv{2} + \inv{2}
%\begin{bmatrix}
%\cos \lr{ 2 \theta } & \sin \lr{ 2 \theta } \\
%\sin \lr{ 2 \theta } & -\cos \lr{ 2 \theta }
%\end{bmatrix}
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1120}
\Proj_\scap
= \scap \scap^\T
=
%\inv{a^2 + b^2}
\begin{bmatrix}
-\cos\theta \\
\sin\theta
\end{bmatrix}
\begin{bmatrix}
-\cos\theta & \sin\theta
\end{bmatrix}
%=
%\inv{a^2 + b^2}
%\begin{bmatrix}
%a^2 & - a b \\
%-a b & b^2
%\end{bmatrix}
=
\begin{bmatrix}
\cos^2\theta & -\cos\theta \sin\theta \\
-\cos\theta \sin\theta & \sin^2 \theta
\end{bmatrix}
=
\inv{2}
\begin{bmatrix}
1 + \cos \lr{ 2 \theta } & -\sin \lr{ 2 \theta } \\
-\sin \lr{ 2 \theta } & 1 - \cos \lr{ 2 \theta }
\end{bmatrix}
%=
%\inv{2} + \inv{2}
%\begin{bmatrix}
%\cos \lr{ 2 \theta } & -\sin \lr{ 2 \theta } \\
%-\sin \lr{ 2 \theta } & -\cos \lr{ 2 \theta }
%\end{bmatrix}
\end{dmath}
\end{subequations}

%%%So the \(A\) and \(B\) matrices are
%%%
%%%\begin{subequations}
%%%\begin{dmath}\label{eqn:twoMassHarmonic:1340}
%%%A =
%%%\begin{bmatrix}
%%%K_1 & 0 \\
%%%0 & K_2
%%%\end{bmatrix}
%%%+
%%%K_3
%%%\sin^2 (\Br \cdot \Bq/2)
%%%\lr{ 1 +
%%%\begin{bmatrix}
%%%\cos \lr{ 2 \theta } & \sin \lr{ 2 \theta } \\
%%%\sin \lr{ 2 \theta } & -\cos \lr{ 2 \theta }
%%%\end{bmatrix}
%%%}
%%%+ K_4 \sin^2 (\Bs \cdot \Bq/2)
%%%\lr{ 1 +
%%%\begin{bmatrix}
%%%\cos \lr{ 2 \theta } & -\sin \lr{ 2 \theta } \\
%%%-\sin \lr{ 2 \theta } & -\cos \lr{ 2 \theta }
%%%\end{bmatrix}
%%%}
%%%\end{dmath}
%%%\begin{dmath}\label{eqn:twoMassHarmonic:1360}
%%%B =
%%%   e^{ i (\Br + \Bs) \cdot \Bq/2 }
%%%\lr{
%%%   K_1
%%%   \cos\lr{ (\Br - \Bs) \cdot \Bq/2 }
%%%   \lr{ 1 +
%%%   \begin{bmatrix}
%%%   \cos \lr{ 2 \theta } & \sin \lr{ 2 \theta } \\
%%%   \sin \lr{ 2 \theta } & -\cos \lr{ 2 \theta }
%%%   \end{bmatrix}
%%%   }
%%%+
%%%   K_2
%%%   \cos\lr{ (\Br + \Bs) \cdot \Bq/2 }
%%%   \lr{ 1 +
%%%   \begin{bmatrix}
%%%   \cos \lr{ 2 \theta } & -\sin \lr{ 2 \theta } \\
%%%   -\sin \lr{ 2 \theta } & -\cos \lr{ 2 \theta }
%%%   \end{bmatrix}
%%%   }
%%%}
%%%\end{dmath}
%%%\end{subequations}

After some manipulation, and the following helper functions

\begin{dmath}\label{eqn:twoMassHarmonic:1380}
\begin{aligned}
\alpha_\pm &= K_3 \sin^2 (\Br \cdot \Bq/2) \pm K_4 \sin^2 (\Bs \cdot \Bq/2) \\
\beta_\pm &= K_1 \cos\lr{ (\Br - \Bs) \cdot \Bq/2 } \pm K_2 \cos\lr{ (\Br + \Bs) \cdot \Bq/2 },
\end{aligned}
\end{dmath}

the block matrices of \eqnref{eqn:twoMassHarmonic:1280a} take the form

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:1400}
A =
\begin{bmatrix}
K_1 + \alpha_+ (1 + \cos\lr{ 2 \theta }) & \alpha_- \sin\lr{ 2 \theta } \\
\alpha_- \sin\lr{ 2 \theta } & K_2 + \alpha_+ (1 - \cos\lr{ 2 \theta })
\end{bmatrix}
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:1420}
B =
   e^{ i (\Br + \Bs) \cdot \Bq/2 }
\begin{bmatrix}
   \beta_+ (1 + \cos \lr{ 2 \theta }) & \beta_- \sin \lr{ 2 \theta } \\
   \beta_- \sin \lr{ 2 \theta } & \beta_+( 1 -\cos \lr{ 2 \theta })
\end{bmatrix}
\end{dmath}
\end{subequations}

A final bit of simplification for \(B\) possible, noting that \(\Br + \Bs = 2 a (0, \sin\theta )\), and \(\Br - \Bs = 2 a(\cos\theta, 0)\), so

\begin{dmath}\label{eqn:twoMassHarmonic:1440}
\beta_\pm = K_1 \cos\lr{ a \cos\theta q_x } \pm K_2 \cos\lr{ a \sin\theta q_y },
\end{dmath}

and

\begin{dmath}\label{eqn:twoMassHarmonic:1480}
B =
   e^{ i a \sin\theta q_y }
\begin{bmatrix}
   \beta_+ (1 + \cos \lr{ 2 \theta }) & \beta_- \sin \lr{ 2 \theta } \\
   \beta_- \sin \lr{ 2 \theta } & \beta_+( 1 -\cos \lr{ 2 \theta })
\end{bmatrix}.
\end{dmath}

It isn't particularly illuminating to expand out the determinant for such a system, even though it can be done symbolically without too much programming.  However, what is easy after formulating the matrix for this system, is actually solving it.  This is done, and animated, in \nbref{twoAtomBasisRectangularLatticeDispersionRelation.cdf}

} % makeanswer

%\EndArticle
