%
% Copyright Â© 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

\paragraph{Attempt II}

Let's be more careful with the exponentiation that led to \eqnref{eqn:threeSpringLoop:440}.  Suppose that we can diagonalize our matrix \(B\) as

\begin{dmath}\label{eqn:threeSpringLoopattemptII:600}
B =
U
\begin{bmatrix}
D & 0 \\
0 & 0
\end{bmatrix}
U^{-1},
\end{dmath}

where \(D\) is diagonal with no zero eigenvalues.  This time we have

\begin{subequations}
\begin{dmath}\label{eqn:threeSpringLoopattemptII:620}
A^{2k} =
\begin{bmatrix}
U & 0 \\
0 & U
\end{bmatrix}
\begin{bmatrix} %%%
\begin{bmatrix}
D^k & 0 \\
0 &   0 \\
\end{bmatrix} &
0 \\
0 &
\begin{bmatrix}
D^k & 0 \\
0 &   0 \\
\end{bmatrix} \\
\end{bmatrix} %%%
\begin{bmatrix}
U^{-1} & 0 \\
0 & U^{-1}
\end{bmatrix}
\end{dmath}
\begin{dmath}\label{eqn:threeSpringLoopattemptII:640}
A^{2k + 1} =
\begin{bmatrix}
U & 0 \\
0 & U
\end{bmatrix}
\begin{bmatrix}
0
&
\begin{bmatrix}
D^k & 0 \\
0 &   0 \\
\end{bmatrix}
\\
\begin{bmatrix}
D^{k+1} & 0 \\
0 &   0 \\
\end{bmatrix}
&
0
\end{bmatrix}
\begin{bmatrix}
U^{-1} & 0 \\
0 & U^{-1}
\end{bmatrix}.
\end{dmath}
\end{subequations}

Observe that we can factor the inner matrix of \eqnref{eqn:threeSpringLoopattemptII:640} as

\begin{dmath}\label{eqn:threeSpringLoopattemptII:660}
\begin{bmatrix}
0
&
\begin{bmatrix}
D^k & 0 \\
0 &   0 \\
\end{bmatrix}
\\
\begin{bmatrix}
D^{k+1} & 0 \\
0 &   0 \\
\end{bmatrix}
&
0
\end{bmatrix}
%%%=
%%%\begin{bmatrix}
%%%0 & 1 \\
%%%1 & 0
%%%\end{bmatrix}
%%%\begin{bmatrix}
%%%\begin{bmatrix}
%%%D^{k+1} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%& 0 \\
%%%0 &
%%%\begin{bmatrix}
%%%D^{k} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%\end{bmatrix}
%%%=
%%%\begin{bmatrix}
%%%0 & 1 \\
%%%1 & 0
%%%\end{bmatrix}
%%%\begin{bmatrix} %%%%
%%%\begin{bmatrix}
%%%D^{1/2} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%& 0 \\
%%%0 &
%%%\begin{bmatrix}
%%%D^{-1/2} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%\end{bmatrix} 	%%%
%%%\begin{bmatrix}
%%%\begin{bmatrix}
%%%D^{k+1/2} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%& 0 \\
%%%0 &
%%%\begin{bmatrix}
%%%D^{k + 1/2} & 0 \\
%%%0 & 0
%%%\end{bmatrix}
%%%\end{bmatrix}
%%%
=
\begin{bmatrix} %%%%
0 &
\begin{bmatrix}
D^{-1/2} & 0 \\
0 & 0
\end{bmatrix} \\
\begin{bmatrix}
D^{1/2} & 0 \\
0 & 0
\end{bmatrix} &
0
\end{bmatrix} %%%%
\begin{bmatrix}
\begin{bmatrix}
D^{k+1/2} & 0 \\
0 & 0
\end{bmatrix}
& 0 \\
0 &
\begin{bmatrix}
D^{k + 1/2} & 0 \\
0 & 0
\end{bmatrix}
\end{bmatrix}
\end{dmath}

Now we can compute the exponentiation.

\begin{dmath}\label{eqn:threeSpringLoopattemptII:680}
e^{A \tau}
=
\begin{bmatrix}
U & 0 \\
0 & U
\end{bmatrix}
\lr{
\begin{bmatrix} %%%
\begin{bmatrix}
\cosh \sqrt{D} \tau & 0 \\
0 & 1 \\
\end{bmatrix} &
0 \\
0 &
\begin{bmatrix}
\cosh \sqrt{D} \tau & 0 \\
0 & 1 \\
\end{bmatrix} \\
\end{bmatrix} %%%
+
\begin{bmatrix} %%%%
0 &
\begin{bmatrix}
1/\sqrt{D} & 0 \\
0 & 0
\end{bmatrix} \\
\begin{bmatrix}
\sqrt{D} & 0 \\
0 & 0
\end{bmatrix} &
0
\end{bmatrix} %%%%
\begin{bmatrix}
\begin{bmatrix}
\sinh \sqrt{D} \tau & 0 \\
0 & 0
\end{bmatrix}
& 0 \\
0 &
\begin{bmatrix}
\sinh \sqrt{D} \tau & 0 \\
0 & 0
\end{bmatrix}
\end{bmatrix}
}
\begin{bmatrix}
U^{-1} & 0 \\
0 & U^{-1}
\end{bmatrix}
\end{dmath}

Combining all the inner matrices we have

\begin{dmath}\label{eqn:threeSpringLoopattemptII:700}
e^{A\tau}
=
\begin{bmatrix}
U & 0 \\
0 & U
\end{bmatrix}
\begin{bmatrix}
%---- row 1
\begin{bmatrix}
\cosh \sqrt{D} \tau  & 0 \\
0 & 1
\end{bmatrix} &
\begin{bmatrix}
(1/\sqrt{D}) \sinh \sqrt D \tau & 0 \\
0 & 0
\end{bmatrix} \\
%---- row 2
\begin{bmatrix}
\sqrt{D} \sinh \sqrt D \tau & 0 \\
0 & 0
\end{bmatrix} &
\begin{bmatrix}
\cosh \sqrt{D} \tau  & 0 \\
0 & 1
\end{bmatrix} \\
%----
\end{bmatrix}
\begin{bmatrix}
U^{-1} & 0 \\
0 & U^{-1}
\end{bmatrix}
\end{dmath}

We now have the correction of \eqnref{eqn:threeSpringLoop:420} that allows for zero eigenvalues

\begin{dmath}\label{eqn:threeSpringLoopattemptII:720}
\begin{bmatrix}
\Bu \\
\Bu'
\end{bmatrix}
=
\begin{bmatrix}
%---- row 1
U
\begin{bmatrix}
\cosh \sqrt{D} \tau  & 0 \\
0 & 1
\end{bmatrix} U^{-1}
&
U \begin{bmatrix}
(1/\sqrt{D}) \sinh \sqrt D \tau & 0 \\
0 & 0
\end{bmatrix} U^{-1}
\\
%---- row 2
U \begin{bmatrix}
\sqrt{D} \sinh \sqrt D \tau & 0 \\
0 & 0
\end{bmatrix} U^{-1}
&
U \begin{bmatrix}
\cosh \sqrt{D} \tau  & 0 \\
0 & 1
\end{bmatrix} U^{-1}
\\
%----
\end{bmatrix}
\begin{bmatrix}
\Bu_0 \\
\Bu_0'
\end{bmatrix},
\end{dmath}

or
\boxedEquation{eqn:threeSpringLoopattemptII:740}{
\Bu =
U
\begin{bmatrix}
\cosh \sqrt{D} \tau  & 0 \\
0 & 1
\end{bmatrix} U^{-1} \Bu_0
+
U \begin{bmatrix}
(1/\sqrt{D}) \sinh \sqrt D \tau & 0 \\
0 & 0
\end{bmatrix} U^{-1} \Bu_0'
}

As one check we have \(\Bu(\tau = 0) = \Bu\) as desired.  However, differentiating \eqnref{eqn:threeSpringLoopattemptII:740} once we should recover the second
row of \eqnref{eqn:threeSpringLoopattemptII:720}, but we get instead

\begin{dmath}\label{eqn:threeSpringLoopattemptII:780}
\Bu' =
U
\begin{bmatrix}
\sqrt{D} \sinh \sqrt{D} \tau  & 0 \\
0 & 0
\end{bmatrix} U^{-1} \Bu_0
+
U
\begin{bmatrix}
\cosh \sqrt D \tau & 0 \\
0 & 0
\end{bmatrix} U^{-1} \Bu_0'
\end{dmath}

Note that the second row of \eqnref{eqn:threeSpringLoopattemptII:720} has a additional term

\begin{dmath}\label{eqn:threeSpringLoopattemptII:n}
U
\begin{bmatrix}
0 & 0 \\
0 & 1
\end{bmatrix} U^{-1} \Bu_0'.
\end{dmath}

What went wrong?

%%%Differentiating twice we recover our equation of motion as expected
%%%
%%%\begin{dmath}\label{eqn:threeSpringLoopattemptII:760}
%%%\Bu''
%%%=
%%%U
%%%\begin{bmatrix}
%%%D \cosh \sqrt{D} \tau  & 0 \\
%%%0 & 0
%%%\end{bmatrix} U^{-1} \Bu_0
%%%+
%%%U \begin{bmatrix}
%%%\sqrt{D} \sinh \sqrt D \tau & 0 \\
%%%0 & 0
%%%\end{bmatrix} U^{-1} \Bu_0'
%%%=
%%%U
%%%\begin{bmatrix}
%%%D & 0 \\
%%%0 & 0
%%%\end{bmatrix} U^{-1} U
%%%\lr{
%%%\begin{bmatrix}
%%%\cosh \sqrt{D} \tau  & 0 \\
%%%0 & 0
%%%\end{bmatrix} U^{-1} \Bu_0
%%%+
%%%\begin{bmatrix}
%%%(1/\sqrt{D}) \sinh \sqrt D \tau & 0 \\
%%%0 & 0
%%%\end{bmatrix} U^{-1} \Bu_0'
%%%}
%%%= B \Bu
%%%\end{dmath}
%%%
%%%However, if I correct that error, the differentiation above doesn't work?
XX
