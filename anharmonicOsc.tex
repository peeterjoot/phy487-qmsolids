%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{anharmonicOsc}
%\renewcommand{\dirname}{notes/phy487/}
%%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{anharmonic oscillator}
%
%\newcommand{\nought}[0]{\circ}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Anharmonic oscillator}
%\chapter{Anharmonic oscillator}
\index{anharmonic oscillator}
%\label{chap:anharmonicOsc}

\makeoproblem{Anharmonic 1D oscillator}{pr:anharmonicOsc:1}{\citep{harald2003solid} pr 5.5}{
How that the equation of motion for an \textAndIndex{anharmonic oscillator}

\begin{dmath}\label{eqn:anharmonicOsc:20}
M \ddot{u} + f u - \inv{2} g u^2 = 0,
\end{dmath}

is solved by an approximate solution involving multiples of the harmonic frequency \(\omega_\nought^2 = f/M\):

\begin{dmath}\label{eqn:anharmonicOsc:40}
u =  \sum_{n = 1}^\infty a_n e^{i n \omega_\nought t} .
\end{dmath}

Discuss the result in relation to phonon decay.  What is the analogy to electrical circuits and to signal transmission in nonlinear media?

} % makeoproblem

\makeanswer{pr:anharmonicOsc:1}{

Let's write our differential equation as

\begin{dmath}\label{eqn:anharmonicOsc:60}
\ddot{u} + \omega_\nought^2 u - h u^2 = 0,
\end{dmath}

where \(g/2M = h\).  Now consider a product of the form \(u^2\)

\begin{dmath}\label{eqn:anharmonicOsc:80}
\begin{aligned}
&\lr{
a_1 e^{ix}
+ a_2 e^{2ix}
+ a_3 e^{3ix}
+ \cdots }
\lr{
a_1 e^{ix}
+ a_2 e^{2ix}
+ a_3 e^{3ix}
+ \cdots } \\
&=
\begin{array}{l l l l l}
a_1 a_1 e^{2 i x} &+ a_1 a_2 e^{3 i x} &+ a_1 a_3 e^{4 i x} &+ a_1 a_4 e^{5 i x} &+ \cdots \\
                  &+ a_2 a_1 e^{3 i x} &+ a_2 a_2 e^{4 i x} &+ a_2 a_3 e^{5 i x} &+ \cdots \\
                  &                    &+ a_3 a_2 e^{4 i x} &+ a_3 a_3 e^{5 i x} &+ \cdots \\
\end{array} \\
&=
a_1^2 e^{2 i x} + a_2^2 e^{4 i x} + a_3^2 e^{6 i x} + \cdots
+ 2 a_1 a_2 e^{3 i x}
+ 2 a_1 a_3 e^{4 i x}
+ \cdots \\
&=
\sum_{n = 1}^\infty a_n^2 e^{2 n i x}
+
2 \sum_{1 \le n < m < \infty} a_n a_m e^{(n + m) i x}.
\end{aligned}
\end{dmath}

Now we are set to take derivatives

\begin{dmath}\label{eqn:anharmonicOsc:100}
\begin{aligned}
0
&= \ddot{u} + \omega_\nought^2 - h u^2 \\
&= \sum_{n = 1}^\infty
\omega_\nought^2 ( 1 - n^2 ) a_n e^{i n \omega_\nought t}
-
h \sum_{n = 1}^\infty a_n^2 e^{2 n i \omega_\nought t}
-
2 h \sum_{1 \le n < m < \infty} a_n a_m e^{(n + m) i \omega_\nought t} \\
&=
\lr{ -3 \omega_\nought^2 a_2 -h a_1^2 } e^{ 2 i \omega_\nought t} \\
&+\lr{ -8 \omega_\nought^2 a_3 - 2 h a_1 a_2 } e^{ 3 i \omega_\nought t} \\
&+\lr{ -15 \omega_\nought^2 a_4 - h a_2^2 } e^{ 4 i \omega_\nought t} \\
&+\lr{ -24 \omega_\nought^2 a_5 - 2 h(a_1 a_4 + a_2 a_3) } e^{ 5 i \omega_\nought t} \\
&+ \cdots
\end{aligned}
\end{dmath}

Setting \(a_1 = 1\) we can proceed to calculate all the constants \(a_n\).

\begin{subequations}
\begin{dmath}\label{eqn:anharmonicOsc:120}
a_2 =
-\frac{h}{3 \omega_\nought^2 }
\end{dmath}
\begin{dmath}\label{eqn:anharmonicOsc:140}
a_3 =
\frac{h^2}{12 \omega_\nought^4 }
\end{dmath}
\begin{dmath}\label{eqn:anharmonicOsc:160}
a_4
=
 -\frac{h }{ 15 \omega_\nought^2 }
\lr{-\frac{h}{3 \omega_\nought^2 } }^2
=
 -\frac{h^3 }{ 135 \omega_\nought^6 }.
\end{dmath}
\end{subequations}

Observe that each of these has powers of

\begin{dmath}\label{eqn:anharmonicOsc:180}
\frac{h}{\omega_\nought^2} = \frac{g}{2 M \omega_\nought^2 } = \frac{g}{2 f}.
\end{dmath}

The magnitude of the anharmonic perturbation ``spring constant'' \(g/2\) compared to the actual spring constant \(f\) is assumed to be small.  This means that the magnitude of each progressive term in the series is smaller than the previous.

This is enough to verify that the solution can be expressed in a series formed from powers of the harmonic frequency phasor.  Looking at a specific example, with \(m = f = 1\), and \(g = 0.5\), we have

\begin{dmath}\label{eqn:anharmonicOsc:200}
u(t) = e^{i t}-0.0833333 e^{2 i t}+0.00520833 e^{3 i t}-0.000115741 e^{4 i t}.
\end{dmath}

The Real part of this is plotted in \cref{fig:anharmonicOsc:anharmonicOscFig1} along with separate plots of the first two terms.

\mathImageFigure{../../figures/phy487/anharmonicOscFig1}{Anharmonic sum and two components}{fig:anharmonicOsc:anharmonicOscFig1}{0.3}{anharmonicOscillator.nb}

Observe that the difference from \(u(t)\) and the harmonic solution is very small.  However, that difference is essentially that of superposition of the \(\omega_\nought\) mode with that of the \(2 \omega_\nought\) mode.  The non-linearity can be thought of as essentially splitting the single harmonic mode into a pair of harmonic modes, one at the fundamental frequency and another (of smaller magnitude) at twice that.  We require a steady state solution of this form, so if we start with something that is just a single frequency, there will be a perturbation process that will result in a decay into the spectrum determined above.  A calculation of that impulse response (very much like initial conditions in a circuit before flipping a switch) would be interesting, but likely difficult.
} % makeanswer

%\EndArticle
